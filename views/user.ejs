<%- include('partials/header') %>
<div class="container">
	<h2 class="text-center text-info">
		Edit your account
	</h2>
</div>

<div class="container d-flex text-dark justify-content-around flex-wrap">
	<div class="align-self-end col-12 col-sm-6 col-lg-5 m-md-3 px-1">
		<form action="/user/details" method="POST">
			<div class="form-group">
				<label for="username">Username</label>
				<input type="text" class="form-control" name="username" placeholder="<%= user.username %>" readonly>
			</div>
			<div class="form-group">
				<label for="email">Email</label>
				<input type="email" class="form-control" name="email" placeholder="<%= user.email %>" value="<%= user.email %>">
        <small id="emailHelp" class="form-text text-secondary">Optional, for password reset only</small>
			</div>
      <div class="form-group">
        <label for="tags"> Your tags </label>
        <% let textareaHeight = 3;
           let textareaContent = null;
           if(user.tags) { 
             textareaHeight = user.tags.length + 1;
             textareaContent = user.tags.reduce((accu, next) => accu +=`${next}\n`, '');
           } %>
        <textarea class="form-control" rows="<%= textareaHeight %>" name="tags" id="tags"><%= textareaContent %></textarea>
        <small id="tagsHelp" class="form-text text-secondary">Put each name in a separate line</small>
      </div>
			<div class="form-group">
				<label for="description">About you</label>
				<textarea class="form-control" name="description" rows="3"><%= user.description %></textarea>
			</div>
			<div class="form-group">
				<button type="submit" class="btn btn-outline-success" > Update </button>
			</div>
		</form>
		
	</div>
	<div class="align-self-end col-12 col-sm-6 col-lg-5 m-md-3 px-1">
    <h4 class="text-center mt-4 text-info">
      Change your password
    </h4>
		<form action="/user/passwordUpdate" method="POST">
			<div class="form-group">
				<label for="currentPassword">Current password</label>
				<input type="password" class="form-control" name="currentPassword">
			</div>
			<div class="form-group">
				<label for="newPassword">New Password</label>
				<input type="password" class="form-control" name="newPassword">
        <small id="passwordlHelp" class="form-text text-secondary">Minimum length is 8, must contain a number</small>
			</div>
			<div class="form-group">
				<button type="submit" class="btn btn-outline-success" > Change password </button>
			</div>
			
		</form> 
	</div>
</div>

<div class="container text-center mt-4">
  <h4 class="text-info">
    Your recent comments
  </h4>  
</div>
<% if (comments.length > 0) { %>
<div class="container bg-light border rounded">
	<% for(let comment of comments) { %>
		<div class="row my-1 py-1 border-bottom justify-content-between">
			<div class="col pb-1">
        <a class="" href="../elements/<%= comment.elementID %>"> <%= comment.text %> </a>
			</div>
			<div class="col-1">
				<form action="../elements/<%= comment.elementID %>/comment/<%= comment._id %>/remove" method="POST">
					<button type="submit" class="close" aria-label="Close">
					  <span aria-hidden="true">&times;</span>
					</button>
				</form>
			</div>	
		</div>
	<% } %>
</div>
<% } %>

<%- include('partials/footer') %>